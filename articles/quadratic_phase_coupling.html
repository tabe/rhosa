<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Detecting quadratic phase coupling from time series data by rhosa • rhosa</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Detecting quadratic phase coupling from time series data by rhosa">
<meta property="og:description" content="rhosa">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rhosa</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/profiling.html">Profiling rhosa's functions</a>
    </li>
    <li>
      <a href="../articles/example.html">Getting started with a simple example</a>
    </li>
    <li>
      <a href="../articles/quadratic_phase_coupling.html">Detecting quadratic phase coupling from time series data by rhosa</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/tabe/rhosa/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Detecting quadratic phase coupling from time
series data by rhosa</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tabe/rhosa/blob/HEAD/vignettes/quadratic_phase_coupling.Rmd" class="external-link"><code>vignettes/quadratic_phase_coupling.Rmd</code></a></small>
      <div class="hidden name"><code>quadratic_phase_coupling.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<p>In this vignette we show how to detect quadratic phase coupling (QPC)
of one-dimensional or multi-dimensional real-valued time series by
<code>bicoherence</code> or <code>cross_bicoherence</code> of rhosa,
respectively. The first section gives an example applying
<code>bicoherence</code> to the data from a simple model exhibiting QPC
at each frequency pair. In the second section we describe a generative
model of three channels with another kind of QPC revealed by
<code>cross_bicoherence</code>. The third section summarizes when and
why <code>bicoherence</code> or <code>cross_bicoherence</code> fails to
recognize a certain type of QPC.</p>
</div>
<div class="section level2">
<h2 id="a-toy-model-of-qpc">A toy model of QPC<a class="anchor" aria-label="anchor" href="#a-toy-model-of-qpc"></a>
</h2>
<p>We begin with importing rhosa:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tabe.github.io/rhosa/" class="external-link">rhosa</a></span><span class="op">)</span></span></code></pre></div>
<p>Our first mathematical model, adapted from [1], is a superposition of
six cosine curves of unit amplitude with different frequencies, named
<span class="math inline">\(x_1\)</span>:</p>
<p><span class="math display">\[x_1(t) = \sum_{i=1}^{6} \cos(\lambda_i t
+ \varphi_i)\]</span></p>
<p>where, for each <span class="math inline">\(i = 1,2,...,6\)</span>,
<span class="math inline">\(\lambda_i\)</span> is given and fixed,
namely</p>
<p><span class="math display">\[
\lambda_1 = 0.55; \lambda_2 = 0.75;
\lambda_3 = \lambda_1 + \lambda_2;
\]</span> <span class="math display">\[
\lambda_4 = 0.6; \lambda_5 = 0.8;
\lambda_6 = \lambda_4 + \lambda_5.
\]</span></p>
<p>On the other hand, we choose <span class="math inline">\(\varphi_i\)</span> (<span class="math inline">\(i
= 1, ..., 5\)</span>) independently from the uniform variable of range
<span class="math inline">\([0, 2\pi)\)</span>, and define</p>
<p><span class="math display">\[
\varphi_6 = \varphi_4 + \varphi_5.
\]</span></p>
<p>Note that the trigonometric identities implies</p>
<p><span class="math display">\[\cos(\lambda_6 t + \varphi_6)
    = \cos((\lambda_4 + \lambda_5) t + (\varphi_4 + \varphi_5))
    = \cos(\lambda_4 t + \varphi_4) \cos(\lambda_5 t + \varphi_5)
    - \sin(\lambda_4 t + \varphi_4) \sin(\lambda_5 t +
\varphi_5),\]</span></p>
<p>so <span class="math inline">\(\cos(\lambda_6 t + \varphi_6)\)</span>
is positively correlated with the product of <span class="math inline">\(\cos(\lambda_4 t + \varphi_4)\)</span> and <span class="math inline">\(\cos(\lambda_5 t + \varphi_5)\)</span>. But <span class="math inline">\(\cos(\lambda_3 t + \varphi_3)\)</span> is not
correlated with the product of <span class="math inline">\(\cos(\lambda_1 t + \varphi_1)\)</span> and <span class="math inline">\(\cos(\lambda_2 t + \varphi_2)\)</span> in general
as the phase <span class="math inline">\(\varphi_3\)</span> is randomly
assigned.</p>
<p>Once <span class="math inline">\(\varphi_i\)</span>s are chosen,
<span class="math inline">\(x_1(t)\)</span> is a periodic function of
<span class="math inline">\(t\)</span>. So it turns out that <span class="math inline">\(x_1\)</span> is a (strictly) stationary stochastic
process. The wave length of any frequency component of <span class="math inline">\(x_1\)</span> is shorter than <span class="math inline">\(4\pi\)</span>. Now consider sampling a realization
of <span class="math inline">\(x_1\)</span> repeatedly during a fixed
length of time, say 256. The sampling rate is 1. That is, the interval
of consecutive samples is 1. The following R code effectively simulates
<span class="math inline">\(x_1\)</span> as <code>x1</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">triple_lambda</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">)</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">triple_lambda</span><span class="op">(</span><span class="fl">0.55</span>, <span class="fl">0.75</span><span class="op">)</span>, <span class="fu">triple_lambda</span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>    <span class="va">init_phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">5</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span></span>
<span>    <span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">init_phi</span>, <span class="va">init_phi</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">init_phi</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">sum</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">l</span>, <span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">l</span> <span class="op">*</span> <span class="va">t</span> <span class="op">+</span> <span class="va">p</span><span class="op">)</span>, <span class="va">lambda</span>, <span class="va">phi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">observe</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, <span class="va">f</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">N1</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">observe</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">N1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Each column of matrix <code>m1</code> in the last line represents a
realization of <code>x1</code>. That is, we have taken 100 realizations
of <span class="math inline">\(x_1\)</span> as <code>m1</code>. Let’s
plot them:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ith_sample</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>i <span class="op">=</span> <span class="va">i</span>, t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span>, v <span class="op">=</span> <span class="va">m1</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">r1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">ith_sample</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">r1</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">v</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          strip.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec1_samples-1.png" alt="100 realizations of `x1`." width="672"><p class="caption">
100 realizations of <code>x1</code>.
</p>
</div>
<p>A realization of <span class="math inline">\(x_1\)</span> looks
like:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">m1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"t"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec1_X1-1.png" alt="The 256 time points in the first realization of `x1`." width="672"><p class="caption">
The 256 time points in the first realization of <code>x1</code>.
</p>
</div>
<p>Its spectrum estimation shows peaks at six frequencies as
expected:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec1_spec-1.png" alt="The spectrum estimation of `x1`." width="672"><p class="caption">
The spectrum estimation of <code>x1</code>.
</p>
</div>
<p>Now we approximate <span class="math inline">\(x_1\)</span>’s
bicoherence by <code>bicoherence</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicoherence.html">bicoherence</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span></code></pre></div>
<p>… and define an R function to plot the heat map of the estimated
bicoherence:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">heatmap_bicoherence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">bc</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bc</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">heatmap_bicoherence</span><span class="op">(</span><span class="va">bc1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec1_heatmap_bc1-1.png" alt="`x1`'s estimated bicoherence." width="672"><p class="caption">
<code>x1</code>’s estimated bicoherence.
</p>
</div>
<p>Note that the highest peak is at the bifrequency <span class="math inline">\((f_1, f_2) = (\frac{\lambda_5}{2 \pi},
\frac{\lambda_4}{2 \pi}) \approx (0.127,
0.095)\)</span>.</p>
</div>
<div class="section level2">
<h2 id="a-three-channel-model-of-quadratic-signal-processing">A three-channel model of quadratic signal processing<a class="anchor" aria-label="anchor" href="#a-three-channel-model-of-quadratic-signal-processing"></a>
</h2>
<p>Another example of QPC consists of three channels, which accept
series of periodic input signals and suffer from Gaussian noises. From a
couple of the channels, say <span class="math inline">\(C_1\)</span> and
<span class="math inline">\(C_2\)</span>, we observe the summation of
input and noises as their output. On the other hand the last channel,
called <span class="math inline">\(C_3\)</span>, adds <span class="math inline">\(C_1\)</span>’s output multiplied by <span class="math inline">\(C_2\)</span>’s to its own input and noise.</p>
The following block diagram shows the skeleton of our three-channel
model.
<figure><img src="data/tc.png" alt="The block diagram of the three-channel model."><figcaption style="text-align: center;">
The block diagram of the three-channel model.
</figcaption></figure><p>Here, assume that <span class="math inline">\(C_1\)</span>’s input is
a triangle wave of a fixed frequency with varying initial phases. A
rectangle wave of another frequency for <span class="math inline">\(C_2\)</span>’s input. A cosinusoidal curve of yet
another frequency for <span class="math inline">\(C_3\)</span>’s input.
Running the following code simulates the model.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fcoef1</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span>
<span><span class="va">Fcoef2</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">Fcoef3</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span></span>
<span><span class="va">i1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span><span class="op">)</span> <span class="op">{</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">asin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">Fcoef1</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">i2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">Fcoef2</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">p</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">i3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">p</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">Fcoef3</span> <span class="op">*</span> <span class="va">x</span> <span class="op">+</span> <span class="va">p</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="va">Qcoef</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span></span>
<span><span class="va">tc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>    <span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">3</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu">i1</span><span class="op">(</span><span class="va">x</span>, <span class="va">ps</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu">i2</span><span class="op">(</span><span class="va">x</span>, <span class="va">ps</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="va">c3</span> <span class="op">&lt;-</span> <span class="va">Qcoef</span> <span class="op">*</span> <span class="va">c1</span> <span class="op">*</span> <span class="va">c2</span> <span class="op">+</span></span>
<span>            <span class="fu">i3</span><span class="op">(</span><span class="va">x</span>, <span class="va">ps</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">c1</span>, <span class="va">c2</span>, <span class="va">c3</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">N2</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="va">sample_tc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span><span class="fu">f</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">256</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="va">tc</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">N2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">c1_data_frame</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span><span class="va">y</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">c1</span><span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">N2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">c2_data_frame</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span><span class="va">y</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">c2</span><span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">N2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">c3_data_frame</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">cbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span><span class="va">y</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">c3</span><span class="op">}</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">N2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fu">sample_tc</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu">c1_data_frame</span><span class="op">(</span><span class="va">y1</span><span class="op">)</span></span>
<span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu">c2_data_frame</span><span class="op">(</span><span class="va">y1</span><span class="op">)</span></span>
<span><span class="va">d3</span> <span class="op">&lt;-</span> <span class="fu">c3_data_frame</span><span class="op">(</span><span class="va">y1</span><span class="op">)</span></span></code></pre></div>
<p>That is, we obtain 100 series of data with 256 points. To be
specific, <span class="math inline">\(C_1\)</span>’s triangle wave has
cycle <span class="math inline">\(\frac{2 \pi}{1.2}\)</span>, the cycle
of <span class="math inline">\(C_2\)</span>’s rectangle wave is <span class="math inline">\(\frac{2 \pi}{0.7}\)</span>, and the one of <span class="math inline">\(C_3\)</span>’s cosinusoidal wave is <span class="math inline">\(\frac{2 \pi}{0.8}\)</span>.</p>
<p><span class="math inline">\(C_1\)</span>’s output looks like:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"t"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_d1-1.png" alt="A sample path of `d1`." width="672"><p class="caption">
A sample path of <code>d1</code>.
</p>
</div>
<p>And <span class="math inline">\(C_2\)</span>’s output:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d2</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"t"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_d2-1.png" alt="A sample path of `d2`." width="672"><p class="caption">
A sample path of <code>d2</code>.
</p>
</div>
<p><span class="math inline">\(C_3\)</span>’s output:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d3</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"t"</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_d3-1.png" alt="A sample path of `d3`." width="672"><p class="caption">
A sample path of <code>d3</code>.
</p>
</div>
<p>Their spectrum estimation show significant peaks at expected
frequencies:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum</a></span><span class="op">(</span><span class="va">d1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_spec1-1.png" alt="The spectrum estimation of C1." width="672"><p class="caption">
The spectrum estimation of C1.
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum</a></span><span class="op">(</span><span class="va">d2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_spec2-1.png" alt="The spectrum estimation of C2." width="672"><p class="caption">
The spectrum estimation of C2.
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum</a></span><span class="op">(</span><span class="va">d3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_spec3-1.png" alt="The spectrum estimation of C3." width="672"><p class="caption">
The spectrum estimation of C3.
</p>
</div>
<p>It is expected that <span class="math inline">\(C_3\)</span>’s
bicoherence shows no outstanding pair of frequencies as <span class="math inline">\(C_3\)</span> does not have any big component of
frequency <span class="math inline">\(\frac{1.2}{2 \pi}\)</span> nor
<span class="math inline">\(\frac{0.7}{2 \pi}\)</span>, but of frequency
<span class="math inline">\(\frac{0.8}{2 \pi}\)</span> and <span class="math inline">\(\frac{1.2+0.7}{2
\pi}\)</span> only:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bc3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bicoherence.html">bicoherence</a></span><span class="op">(</span><span class="va">d3</span><span class="op">)</span></span>
<span><span class="fu">heatmap_bicoherence</span><span class="op">(</span><span class="va">bc3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_heatmap_bc3-1.png" alt="`d3`'s estimated bicoherence." width="672"><p class="caption">
<code>d3</code>’s estimated bicoherence.
</p>
</div>
<p>Now we calculate the estimated cross-bicoherence between <span class="math inline">\(C_1\)</span>, <span class="math inline">\(C_2\)</span>, and <span class="math inline">\(C_3\)</span> by <code>cross_bicoherence</code>,
and plot the heat map of the results:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cb123</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_bicoherence.html">cross_bicoherence</a></span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span>, <span class="va">d3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">heatmap_cross_bicoherence</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">cb</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">cb</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_raster</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">f1</span>, <span class="va">f2</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html" class="external-link">scale_alpha</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">heatmap_cross_bicoherence</span><span class="op">(</span><span class="va">cb123</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Raster pixels are placed at uneven horizontal intervals and will be shifted</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Consider using `geom_tile()` instead.</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_heatmap_cb123-1.png" alt="The estimated cross-bicoherence between C1, C2, and C3." width="672"><p class="caption">
The estimated cross-bicoherence between C1, C2, and C3.
</p>
</div>
<p>Notice the high values around bifrequencies <span class="math inline">\((f_1, f_2) = (\frac{1.2}{2 \pi}, \frac{0.7}{2
\pi}) \approx (0.191, 0.111)\)</span> and <span class="math inline">\((f_1, f_2) = (\frac{1.2}{2 \pi}, -\frac{0.7}{2
\pi}) \approx (0.191, -0.111)\)</span>. It means that the QPC in the
model is correctly identified.</p>
<p>How about changing the order of cross-bicoherence’s arguments? Let’s
estimate the one between <span class="math inline">\(C_3\)</span>, <span class="math inline">\(C_1\)</span>, and <span class="math inline">\(C_2\)</span>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cb312</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_bicoherence.html">cross_bicoherence</a></span><span class="op">(</span><span class="va">d3</span>, <span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></span>
<span><span class="fu">heatmap_cross_bicoherence</span><span class="op">(</span><span class="va">cb312</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Raster pixels are placed at uneven horizontal intervals and will be shifted</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Consider using `geom_tile()` instead.</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec2_heatmap_cb312-1.png" alt="The estimated cross-bicoherencde between C3, C1, and C2." width="672"><p class="caption">
The estimated cross-bicoherencde between C3, C1, and C2.
</p>
</div>
<p>Now the pairs of frequencies <span class="math inline">\((f_1, f_2) =
(\frac{1.2-0.7}{2 \pi}, -\frac{1.2}{2 \pi}) \approx (0.080,
-0.191)\)</span> and <span class="math inline">\((f_1, f_2) =
(\frac{1.2+0.7}{2 \pi}, -\frac{1.2}{2 \pi}) \approx (0.302,
-0.191)\)</span> are in highlights.</p>
</div>
<div class="section level2">
<h2 id="when-and-why-existing-qpc-is-not-apparent-from-the-estimated-cross-bicoherence">When and why existing QPC is not apparent from the estimated
cross-bicoherence<a class="anchor" aria-label="anchor" href="#when-and-why-existing-qpc-is-not-apparent-from-the-estimated-cross-bicoherence"></a>
</h2>
<p>Using the three-channel model in the previous section, let’s see some
examples of QPC which does not exhibit a higher value of the coupling
bifrequency in problem.</p>
<p>The most straightforward reason of invisible QPC is the weakness of
the coupling strength. It is reproducible by taking a small
<code>Qcoef</code> in our model.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Qcoef</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span></span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fu">sample_tc</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cb2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_bicoherence.html">cross_bicoherence</a></span><span class="op">(</span><span class="fu">c1_data_frame</span><span class="op">(</span><span class="va">y2</span><span class="op">)</span>, <span class="fu">c2_data_frame</span><span class="op">(</span><span class="va">y2</span><span class="op">)</span>, <span class="fu">c3_data_frame</span><span class="op">(</span><span class="va">y2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">heatmap_cross_bicoherence</span><span class="op">(</span><span class="va">cb2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Raster pixels are placed at uneven horizontal intervals and will be shifted</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Consider using `geom_tile()` instead.</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec3_weak_coupling-1.png" alt="The case of weak coupling." width="672"><p class="caption">
The case of weak coupling.
</p>
</div>
<p>Another reason of undetectable QPC is that the coupling bifrequency
is in the outside of the region sufficiently sampled. The following
example demonstrates that the <code>f1</code> of the bifrequency almost
equals to the Nyquist frequency. If <code>Fcoef1</code> exceeds <span class="math inline">\(\pi\)</span>, it will be no longer
identifiable.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fcoef1</span> <span class="op">&lt;-</span> <span class="va">pi</span> <span class="op">-</span> <span class="fl">0.1</span></span>
<span><span class="va">Fcoef2</span> <span class="op">&lt;-</span> <span class="fl">2.3</span></span>
<span><span class="va">Fcoef3</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">Qcoef</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span></span>
<span><span class="va">y3</span> <span class="op">&lt;-</span> <span class="fu">sample_tc</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cb3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_bicoherence.html">cross_bicoherence</a></span><span class="op">(</span><span class="fu">c1_data_frame</span><span class="op">(</span><span class="va">y3</span><span class="op">)</span>, <span class="fu">c2_data_frame</span><span class="op">(</span><span class="va">y3</span><span class="op">)</span>, <span class="fu">c3_data_frame</span><span class="op">(</span><span class="va">y3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">heatmap_cross_bicoherence</span><span class="op">(</span><span class="va">cb3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Raster pixels are placed at uneven horizontal intervals and will be shifted</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Consider using `geom_tile()` instead.</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec3_too_high_frequency-1.png" alt="The case of nearly-Nyquist frequency of `f1`." width="672"><p class="caption">
The case of nearly-Nyquist frequency of <code>f1</code>.
</p>
</div>
<p>Last but not least, undersampling also ends up with missing QPC. If
the number of samples <code>N2</code> is too small, we cannot
distinguish the coupling bifrequency from the others.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fcoef1</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span>
<span><span class="va">Fcoef2</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">Fcoef3</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span><span class="va">Qcoef</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span><span class="va">N2</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">y4</span> <span class="op">&lt;-</span> <span class="fu">sample_tc</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cb4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_bicoherence.html">cross_bicoherence</a></span><span class="op">(</span><span class="fu">c1_data_frame</span><span class="op">(</span><span class="va">y4</span><span class="op">)</span>, <span class="fu">c2_data_frame</span><span class="op">(</span><span class="va">y4</span><span class="op">)</span>, <span class="fu">c3_data_frame</span><span class="op">(</span><span class="va">y4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">heatmap_cross_bicoherence</span><span class="op">(</span><span class="va">cb4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Raster pixels are placed at uneven horizontal intervals and will be shifted</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Consider using `geom_tile()` instead.</span></span></code></pre></div>
<div class="figure">
<img src="quadratic_phase_coupling_files/figure-html/sec3_undersampling-1.png" alt="The case of insufficient sample." width="672"><p class="caption">
The case of insufficient sample.
</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>Using numerical simulation of time series of stationary stochastic
processes, we have demonstrated that rhosa’s <code>bicoherence</code>
and <code>cross_bicoherence</code> can suggest the bifrequencies of
potential QPC. Although some assumptions on the time series,
e.g. stationarity, must be satisfied for accurate estimation, there is
no additional cost except for the computing time if the first-order
spectral analysis has been adopted already. The API lowers the barrier
preventing from applying the bispectral analysis to time series for an
exploratory purpose. Considering appropriate generative models helps
interpretation of the result obtained from the analysis.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>[1] Petropulu, A.P., 1994. Higher-Order Spectra in Biomedical Signal
Processing. IFAC Proceedings Volumes, IFAC Symposium on Modelling and
Control in Biomedical Systems, Galveston, TX, USA, 27-30 March 1994 27,
47–52. <a href="https://doi.org/10.1016/S1474-6670%2817%2946158-1" class="external-link uri">https://doi.org/10.1016/S1474-6670%2817%2946158-1</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Takeshi Abe.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
